<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><link rel=icon type=image/ico href=https://bnmoch3.org/favicon.ico?><link rel=icon type=image/png sizes=16x16 href=https://bnmoch3.org/favicon-16x16.png?><link rel=icon type=image/png sizes=32x32 href=https://bnmoch3.org/favicon-32x32.png?><link rel=icon type=image/png sizes=192x192 href=https://bnmoch3.org/android-chrome-192x192.png?><link rel=apple-touch-icon sizes=180x180 href=https://bnmoch3.org/apple-touch-icon.png?><meta name=description content><title>Larger-Than-Memory Data Management | bnmoch3</title><link rel=canonical href=https://bnmoch3.org/p/larger-than-mem-intro/><meta property="og:url" content="https://bnmoch3.org/p/larger-than-mem-intro/"><meta property="og:site_name" content="bnmoch3"><meta property="og:title" content="Larger-Than-Memory Data Management"><meta property="og:description" content="For when the database exceeds the main memory size"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-04T00:00:00+00:00"><meta property="article:modified_time" content="2024-06-04T00:00:00+00:00"><meta property="article:tag" content="Database Internals"><link rel=stylesheet href=/assets/combined.min.bfb51fa3110844de3117ce8da7190d50165deb2fc526273808d6975119098310.css media=all></head><body class=light><div class=content><header><div class=header><div class=flex><p class=small><a href=/>/home</a></p><p class=small><a href=/about>/about</a></p><p class=small><a href=/posts>/posts</a></p><p class=small><a href=/notes>/notes</a></p><p class=small><a href=/tags>/tags</a></p></div></div></header><main class=main><div class=breadcrumbs><a href=/>Home</a>
<span class=breadcrumbs-separator>> </span><a href=/posts/>Posts</a>
<span class=breadcrumbs-separator>> </span><a class=breadcrumbs-current href=/p/larger-than-mem-intro/>Larger-Than-Memory Data Management</a></div><div><div class=single-intro-container><h1 class=single-title>Larger-Than-Memory Data Management</h1><p class=single-readtime><time datetime=2024-06-04T00:00:00+00:00>June 4, 2024</time>
&nbsp; · &nbsp;
3 min read</p></div><div class=single-content><p>According to [1], the ideal DBMS is one that &ldquo;has high performance,
characteristic of main-memory databases, when the working set fits in RAM&rdquo; and
&ldquo;the ability of a traditional disk-based database engine to keep cold data on
the larger and cheaper storage media, while supporting, as efficiently as
possible, the infrequent cases where data needs to be retrieved from secondary
storage&rdquo;.</p><p>To realize a system that achieves both requirements, there are two approaches:
(1) take a disk-based databases and optimize it for the former, or (2) take a
main-memory database and optimize it for the latter.</p><p>The first approach would require a full architectural rework. This is because
there isn&rsquo;t one single glaring bottleneck - everything from the buffer pool
manager to the recovery component contributes constant significant overhead with
&lsquo;useful work&rsquo; comprising a small fraction of instructions processed in a query
(figure from &lsquo;OLTP Through the Looking Glass, and What We Found There&rsquo;):</p><p><figure><div><img loading=lazy alt="figure 1" src=/p/larger-than-mem-intro/images/oltp_through_the_looking_glass.png width=476px height=438px></div></figure></p><p>Hence the current tendency to favour the second approach [8,9]: take highly
optimized main-memory systems and extend them to handle larger-than-memory
workloads. This is key not just for resource flexibility but also for lowering
costs: DRAM is still quite costly while SSDs have gotten drastically cheaper and
offer greater performance (IOPS). There&rsquo;s also data skew - a some parts of data
tends to be hot while most of the data tends to be cold. Therefore, it makes
more economic sense to keep hot data in main-memory and only page in cold data
from secondary storage when needed [6,4,5]. Since most queries will hit the hot
memory-resident data, the overall impact on performance should be minimal.</p><p>There are a couple of considerations when it comes to larger-than-memory
approaches: how should the system identify hot data from cold (offline periodic
analysis vs online), what is the granularity of identification (page-level or
record-level), how is metadata maintained, how should queries that touch cold
data be handled (synchronous retrieval or abort-and-restart), and so on [7,8].
This is why I&rsquo;ve decided to do an informal survey of all the
&rsquo;larger-than-memory&rsquo; techniques out there in the next couple of posts, so that I
can understand the trade-offs and get a glimpse of the cutting edge. Do stay
tuned!.</p><p>Update: I&rsquo;m done!. Here&rsquo;s the list:</p><ol><li><a href=/notes/2024/anti-caching/>Anti-Caching</a></li><li><a href=/notes/2024/project-siberia-hot-cold-id/>Offline Classification of Hot and Cold Data</a></li><li><a href=/notes/2024/efficient-os-paging-hot-cold-db/>Hot/Cold Data-Reorganization in Virtual Memory for efficient OS Paging</a></li><li><a href=/notes/2024/hyper-compaction/>Compacting Transactional Data in HyPer DB</a></li><li><a href=/notes/2024/pointer-swizzling/>Utilizing Pointer Swizzling in Buffer Pools</a></li><li><a href=/notes/2024/two-tree/>Tiered Stroage via 2-Tree</a></li><li><a href=/p/leanstore/>Leanstore: High Performance Low-Overhead Buffer Pool</a></li></ol><h2 class=heading id=references>References
<a href=#references>#</a></h2><ol><li><a href=https://www.inf.ufpr.br/carmem/oficinaBD/artigos2s2013/a7-stoica.pdf>Enabling Efficient OS Paging for Main-Memory OLTP Databases - Radu Stoica, Anastasia Ailamaki</a></li><li><a href=https://dl.acm.org/doi/10.1145/1376616.1376713>OLTP through the looking glass, and what we found there - Stavros Harizopoulos, Daniel Abadi, Samuel Madden, Michael Stonebraker</a></li><li><a href=http://nms.csail.mit.edu/~stavros/pubs/hstore.pdf>The End of an Architectural Era (It’s Time for a Complete Rewrite) - Michael Stonebraker et al</a></li><li><a href=https://dl.acm.org/doi/pdf/10.1145/38714.38755>The 5 Minute Rule for Trading Memory for Disc Accesses and The 10 byte Rule for Trading Memory for CPU Time - Jim Gray</a></li><li><a href=https://cs-people.bu.edu/mathan/reading-groups/papers-classics/5minrule2019.pdf>The Five Minute Rule 30 Years Later and Its Impact on the Storage Hierarchy - Raja Appuswamy, Goetz Graefe, Renata Borovica-Gajic, Anastasia Ailamaki</a></li><li><a href=https://www.semanticscholar.org/paper/Data-Caching-Systems-Win-the-Cost-Performance-Game.-Lomet/c8d099c4d3b441e9c1b83a6af46b484afc4979bc>Data Caching Systems Win the Cost/Performance Game - David Lomet</a></li><li><a href="https://www.youtube.com/watch?v=oVro2uEzQ9s">Larger-Than-Memory Database Architectures - Andy Pavlo - CMU Advanced Database Systems Spring 2020</a></li><li><a href=https://dl.acm.org/doi/pdf/10.1145/2933349.2933358>Larger-than-Memory Data Management on Modern Storage Hardware for In-Memory OLTP Database Systems - Lin Ma et al</a></li><li><a href=https://redis.io/blog/introducing-auto-tiering/>Auto Tiering Offers Twice the Throughput at Half the Latency for Large Datasets - Alon Magrafta - Redis</a></li><li><a href=https://memgraph.com/blog/in-memory-vs-disk-based-databases-larger-than-memory-architecture>In-memory vs. disk-based databases: Why do you need a larger than memory architecture? - Andi Skrgat - Memgraph</a></li></ol><script src=https://giscus.app/client.js data-repo=bnmoch3/blog data-repo-id=R_kgDOIU86DQ data-category data-category-id=DIC_kwDOIU86Dc4Clvgl data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=gruvbox_light data-lang=en data-loading=lazy crossorigin=anonymous async></script></div><div class=single-pagination><hr><div class=flex><div class=single-pagination-next><div class=single-pagination-container-next><div class=single-pagination-text>←</div><div class=single-pagination-text><a href=/p/leanstore/>Leanstore: High Performance Low-Overhead Buffer Pool</a></div></div></div><div class=single-pagination-prev><div class=single-pagination-container-prev><div class=single-pagination-text><a href=/p/dbms-hybrid-locking/>Hybrid Locking & Synchronization</a></div><div class=single-pagination-text>→</div></div></div></div><hr></div><div class=back-to-top><a href=#top>back to top</a></div></div></main></div><footer><p>&mldr;</p></footer><script async src=https://scripts.simpleanalyticscdn.com/latest.js></script></body><script>function isAuto(){return document.body.classList.contains("auto")}function setTheme(){if(!isAuto())return;document.body.classList.remove("auto");let e="light";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(e="dark"),document.body.classList.add(e)}function invertBody(){document.body.classList.toggle("dark"),document.body.classList.toggle("light")}isAuto()&&window.matchMedia("(prefers-color-scheme: dark)").addListener(invertBody),setTheme()</script></html>